#!/bin/bash

## Copyright (C) 2019 - 2019 ENCRYPTED SUPPORT LP <adrelanos@riseup.net>
## See the file COPYING for copying conditions.

set -x
set -e

systemctl enable hide-hardware-info.service

touch /etc/noexec

mkdir -p /etc/sysctl.d

echo "\
## This is an automatically generated file.
## This file was automatically generated by:
## $0
## Edits may be lost!

## https://www.whonix.org/wiki/Linux_Kernel_Runtime_Guard_LKRG#Configuration
lkrg.ci_panic=1
lkrg.umh_lock=1" > /etc/sysctl.d/40-security-misc-autogenerated.conf

pam-auth-update --enable console-lockdown-security-misc
